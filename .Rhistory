inf <- data.frame(rawdatamat[1,129:(128+lengthvec[1])])
inf
length(inf)
data.frame(rawdatamat[2,129:(128+lengthvec[2])])
lengthvec
catecom <- c()
for (subj in 1:3){
for (i in 1:lengthvec[subj]-9){
if(sum(inf[i:i+10]==10)){catecom[subj]=catecom[subj]+1}
}
}
inf
inf[1:10]
catecom
for (i in 1:lengthvec[1]-9){
if(sum(inf[i:i+9]==10)){catecom[subj]=catecom[subj]+1}
}
catecom
catecom+1
catecom <- c(0)
for (i in 1:lengthvec[1]-9){
if(sum(inf[i:i+9]==10)){catecom[subj]=catecom[subj]+1}
}
catecom
inf[1:10]
lengthvec[1]-9
sum(inf[1:10])
sum(inf[1:10])==9
sum(inf[1:10])==10
for (i in 1:lengthvec[1]-9){
if(sum(inf[i:i+9]==10)){catecom=catecom+1}
}
catecom
lengthvec
inf
catecom
catecom=c(0)
for (i in 1:lengthvec[1]-9){
if(sum(inf[i:i+9]==10)){catecom <- catecom+1}
}
catecom
for (i in 1:lengthvec[1]-9){
if(sum(inf[i:i+9]==10)){catecom <- catecom+1}
catecom
}
catecom
lengthvec[1]-9
1:61
sum(inf[2:2+9])
catecom=c(0)
for (i in 1:(lengthvec[1]-9)){
if(sum(inf[i:(i+9)]==10)){catecom <- catecom+1}
catecom
}
catecom
1:(lengthvec[1]-9)
inf[1:(1+9)]
sum(inf[2:(2+9)])
catecom
catecom+1
for (i in 1:(lengthvec[1]-9)){
if(sum(inf[i:(i+9)]==10)){catecom <- catecom+1}
}
catecom
a=0
for (i in 1:(lengthvec[1]-9)){
a=a+1
if(sum(inf[i:(i+9)]==10)){catecom <- catecom+1}
}
a
a=0
for (i in 1:(lengthvec[1]-9)){
a=a+1
if(sum(inf[i:(i+9)]==10)){catecom = catecom+1}
}
catecom
b=0
for (i in 1:(lengthvec[1]-9)){
a=a+1
if(sum(inf[i:(i+9)]==10)){
catecom = catecom+1
b=b+1}
}
b
a
inf
a=0
for (i in 1:(lengthvec[1]-9)){
a=a+1
if(sum(inf[i:(i+9)])==10){
catecom = catecom+1
}
}
catecom
?grep
inf==0
?which
which(inf==0)
locvec <- which(inf==0)
locvec
catecom=0
for(i in 1:(length(locvec)-1))
if(sum(inf[locvec[i]:locvec[i+1]])>=10){catecom=catecom+1}
catecom
inf
locvec
(length(locvec)-1)
sum(inf[locvec[1]:locvec[1+1]])
sum(inf[locvec[2]:locvec[2+1]])
sum(inf[locvec[3]:locvec[3+1]])
sum(inf[locvec[4]:locvec[4+1]])
sum(inf[locvec[5]:locvec[5+1]])
inf[1:]
catecom=0
locvec <- which(inf==0)
for(i in 1:(length(locvec)-1)) {
if(sum(inf[locvec[i]:locvec[i+1]])>=10){catecom=catecom+1}
if((i == (length(locvec)-1)) & sum(inf[i:length(inf)])==10){
catecom=catecom+1
}
}
catecom
length(locvec)-1
(i == (length(locvec)-1)
i
i == (length(locvec)-1
a == (length(locvec)-1
i == (length(locvec)-1)
i
sum(inf[i:length(inf)])
i
sum(inf[locvec[i]:length(inf)]
)
length(inf)
locvec
inf[locvec[i+1]:length(inf)]
sum(inf[locvec[i+1]:length(inf)])
catecom=0
locvec <- which(inf==0)
for(i in 1:(length(locvec)-1)) {
if(sum(inf[locvec[i]:locvec[i+1]])>=10){catecom=catecom+1}
if((i == (length(locvec)-1)) & sum(inf[locvec[i+1]:length(inf)])==10){
catecom=catecom+1
}
}
catecom
subj
rm(list=ls())
load("Code17b_WCST S_s1-3_iter100.Rdata")
subjectsmodeled
#calculate categories completed
subj_catecom <- c()
for (subj in subjectsmodeled){
inf <- data.frame(rawdatamat[subj,129:(128+lengthvec[subj])])
catecom=0
locvec <- which(inf==0)
for(i in 1:(length(locvec)-1)) {
if(sum(inf[locvec[i]:locvec[i+1]])>=10){catecom=catecom+1}
if((i == (length(locvec)-1)) & sum(inf[locvec[i+1]:length(inf)])==10){catecom=catecom+1}
}
subj_catecom[subj] <- catecom
}
subj_catecom
subjectsmodeled
rawdatamat[2,129:(128+lengthvec[2])]
inf
locvec
#failure to maintain set
subj_failure <- c()
for (subj in subjectsmodeled){
inf <- data.frame(rawdatamat[subj,129:(128+lengthvec[subj])])
failure=0
locvec <- which(inf==0)
for(i in 1:(length(locvec)-1)) {
if((sum(inf[locvec[i]:locvec[i+1]])<10 & sum(inf[locvec[i]:locvec[i+1]]) >= 5)){failure = failure+1}
}
subj_failure[subj] <- failure
}
subj_failure
subj_catecom
sid_catecom <- mean(subj_catecom[2:3])
#create graph
control_catecom <- subj_catecom[1]
sdi_catecom <- mean(subj_catecom[2:3])
control_catecom
sdi_catecom
barplot(control_catecom, sdi_catecom)
barplot(subj_catecom)
subj_catecom <- c(control_catecom, sdi_catecom); barplot(subj_catecom)
barplot(subj_catecom)
subj_catecom <- c(control_catecom, sdi_catecom); rownames(subj_catecom) <- c("Control", "SDI")
subj_catecom <- data.frame(Control=control_catecom, SDI=sdi_catecom)
subj_catecom
barplot(subj_catecom)
kable(subj_catecom)
library(knitr)
kable(subj_catecom)
##graph
control_failure <- subj_failure[1]
sdi_failure <- mean(subj_failure[2:3])
subj_failure <- data.frame(Control=control_failure, SDI=sdi_failure)
subj_failure
#integrate
total <- data.frame(subj_catecom, subj_failure)
total
#integrate
total <- rbind(subj_catecom, subj_failure)
total
#integrate
total <- t(rbind(subj_catecom, subj_failure))
total
colnames(total) <- c("Categories Completed","Set Failure")
total
barplot(total)
kable(total)
#graph
library(ggplot2)
total
subj_catecom
#calculate categories completed
subj_catecom <- c()
for (subj in subjectsmodeled){
inf <- data.frame(rawdatamat[subj,129:(128+lengthvec[subj])])
catecom=0
locvec <- which(inf==0)
for(i in 1:(length(locvec)-1)) {
if(sum(inf[locvec[i]:locvec[i+1]])>=10){catecom=catecom+1}
if((i == (length(locvec)-1)) & sum(inf[locvec[i+1]:length(inf)])==10){catecom=catecom+1}
}
subj_catecom[subj] <- catecom
}
subj_com
subj_catecom
##data frame
control_catecom <- subj_catecom[1]
sdi_catecom <- mean(subj_catecom[2:3])
subj_catecom <- data.frame(group=c("Control", "SDI"), score=rep("Categoreis Completed",2), value=c(control_catecom, sdi_catecom))
subj_catecom
subj_failure <- data.frame(group=c("Control", "SDI"), score=rep("Set Failures",2), value=c(control_failure, sdi_failure))
subj_failure
#integrate
total <- rbind(subj_catecom, subj_failure)
total
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=len-sd, ymax=len+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic()
stderr(totla$value)
stderr(total$value)
?stderr
sd(total$value)
totla$value
total$value
#integrate
sd <- c(sd(total[score=="Categories Completed", "value"]), sd(total[score=="Set Failures", "value"]))
#integrate
sd <- c(sd(total[total$score=="Categories Completed", "value"]), sd(total[total$score=="Set Failures", "value"]))
sd
total[total$score=="Categories Completed", "value"]
total[total$score=="Set Failures", "value"]
total$score
total[total$score=="Categoreis Completed", "value"]
#integrate
sd <- c(sd(total[total$score=="Categoreis Completed", "value"]), sd(total[total$score=="Set Failures", "value"]))
sd
total <- rbind(subj_catecom, subj_failure); total <- cbind(total, sd)
sd
total
sd
?rep
sd <- rep(sd, each=2)
sd
total <- total[,-4]
total
total <- cbind(total, sd)
total
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic()
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','ligthgray')) +
theme_classic()
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','lightgray')) +
theme_classic()
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','lightgray')) +
theme_minimal()
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_()
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic()
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(1,1))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.5,1))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75)) +
scale_fill_discrete("")
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75)) +
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75)) +
legend.title = theme_blank()
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75)) +
guide_legend(title=NULL)
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge()) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white')) +
theme_classic() +
theme(legend.position = c(0.75,0.75)) +
guide_legend(title=NULL)
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=.2,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd),
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.5,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.05,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.1,
position=position_dodge(.9))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.1,
position=position_dodge(.5))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 6.5))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.1,
position=position_dodge(.5))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
#scale_y_continuous(expand = c(0, 0), limits = c(0, 6.5)) for deleting the space of x-axis
total
rownames(total)[3] <- "Observed Value"
total
rm(rownames(total)[3])
rownames(total)[3] <- NA
rownames(total)[3] <- 3
colnames(total)[3] <- "Observed Value"
total
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.1,
position=position_dodge(.5))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL))
rm(bp)
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.1,
position=position_dodge(.5))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL))
bp
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
total
bp <- ggplot(total, aes(x=score, y="Observed Value", fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin="Observed Value"-sd, ymax="Observed Value"+sd), width=0.1,
position=position_dodge(.5))
bp
colnames(total)[3] <- "value""
colnames(total)[3] <- "value"
colnames(total)[3] <- "value"
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.1,
position=position_dodge(.5))
bp + labs(title="(A) Observed Data") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp + labs(title="(A) Observed Data", xlab="", ylab="Observed Value") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp <- ggplot(total, aes(x=score, y=value, fill=group)) +
geom_bar(colour="black", stat="identity", position=position_dodge(), width=0.5) +
geom_errorbar(aes(ymin=value-sd, ymax=value+sd), width=0.1,
position=position_dodge(.5))
bp + labs(title="(A) Observed Data", xlab="", ylab="Observed Value") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
bp + labs(title="(A) Observed Data", x="", y="Observed Value") +
scale_fill_manual(values=c('black','white'), guide = guide_legend(title=NULL)) +
theme_classic() +
theme(legend.position = c(0.75,0.75))
total
subj_failure
subj_catecom
#integrate
sd <- c(sd(subj_catecom[,"value"]), sd(subj_failure[,"value"]))
sd
