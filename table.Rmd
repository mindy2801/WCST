
#Replicating Tables within the paper
##Table.2 Mean BIC for 24 Models
```{r echo=FALSE}
load("Code17b_choice_s1-88_iter100.Rdata")
    options(knitr.kable.NA = '') #hide NA
https://cran.r-project.org/web/packages/kableExtra/kableExtra.pdf

    
library(knitr)
library(kableExtra)
        
#Average BIC
meanBIC <- colMeans(BICfinalmat)
meanBIC <- meanBIC[!is.na(meanBIC)]

#Create table tags
names <- expand.grid(i=c("i","0","1"),d=c("d",""),p=c("p",""))
names <- as.matrix(names)
for(i in 2:3){
loc <- names[,i]==""
names[loc,i] <- "fixed"
names[!loc,i] <- "free"
}
loc <- names[,1]=="i"
names[loc,1] <- "fixed"

#Create table
t <- data.frame(meanBIC, names)
t2 <- as.data.frame(matrix(t[,1], ncol=3, byrow=T))
t2[,4] <- NA; t2[1,4] <- mean(catt33G2) #deckbaseBIC is strange

colnames(t2)<-c("f free", "f = 0", "f = 1", "Baseline model")
row_t2 <- data.frame(v1=c(rep("p free", 2),rep("p = r", 2)),v2=c(rep(c("d free", "d = 1"),2)),t2)

kable(row_t2, format="html", col.names=c("","",colnames(t2)), caption="Table 2", algin="l") %>%
  kable_styling(bootstrap_options = "striped",
                full_width = F) %>%
  collapse_rows(columns=1:2) %>%
  add_header_above(c("Model constraints"=6))
  

```

##Fig.2 Observed Scores for categories completed/presev error/nonperserv error/set failures
```
```

##Fig.2 Model Simulation
```
```

##Original code: Mean Parameters for rpd1 Model
```{r echo=FALSE}
load("Code17b_choice_s1-88_iter100.Rdata")

##Table.3
dat_sdi <- parstack[1:39,1:3,5]
dat_control <- parstack[40:88,1:3,5]
mean_s <- apply(dat_sdi,2,mean)
mean_c <- apply(dat_control,2,mean)
median_s <- apply(dat_sdi,2,median)
median_c <- apply(dat_control,2, median)
sd_s <- apply(dat_sdi, 2, sd)
sd_c <- apply(dat_control, 2, sd)

t3 <- rbind(mean_c,mean_s,median_c,median_s,sd_c,sd_s)
t3 <- as.data.frame(t3)



T_org <- kable(t3, format = "html", caption = "Original Code", align="l") %>%
  kable_styling(bootstrap_options = "striped",
                full_width = F) %>%
  add_header_above(c("Group"=1, "Parameters" = 3)) %>%
  group_rows("Mean", 1,2) %>%
  group_rows("Median", 3,4) %>%
  group_rows("Standard deviation", 5,6)



```

##DY code: Mean Parameters for rpd1 Model
```{r echo=FALSE}
load("DY_MLE.Rdata")

##Table.3
dat_control <- parstack[1:49,1:3,5]
dat_sdi <- parstack[50:88,1:3,5]
mean_s <- apply(dat_sdi,2,mean)
mean_c <- apply(dat_control,2,mean)
median_s <- apply(dat_sdi,2,median)
median_c <- apply(dat_control,2, median)
sd_s <- apply(dat_sdi, 2, sd)
sd_c <- apply(dat_control, 2, sd)

t3 <- rbind(mean_c,mean_s,median_c,median_s,sd_c,sd_s)
t3 <- as.data.frame(t3)



T_DY<- kable(t3, format = "html", caption = "DY Code", align="l") %>%
  kable_styling(bootstrap_options = "striped",
                full_width = F) %>%
  add_header_above(c("Group"=1, "Parameters" = 3)) %>%
  group_rows("Mean", 1,2) %>%
  group_rows("Median", 3,4) %>%
  group_rows("Standard deviation", 5,6)



```
